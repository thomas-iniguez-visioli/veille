---
title: CVE-2025-37953
date: 2025-5-20
lien: "https://cvefeed.io/vuln/detail/CVE-2025-37953"

---

CVE ID : CVE-[[2025]]-37953

Published :  May 20
2025
4:15 p.m. | 33Â minutes ago

Description : In the Linux [[kernel]]
the following vulnerability has been resolved:

sch_htb: make htb_deactivate() idempotent

Alan reported a NULL pointer dereference in htb_next_rb_node()
after we made htb_qlen_notify() idempotent.

It turns out in the following case it introduced some regression:

htb_dequeue_tree():
  |-> fq_codel_dequeue()
    |-> qdisc_tree_reduce_backlog()
      |-> htb_qlen_notify()
        |-> htb_deactivate()
  |-> htb_next_rb_node()
  |-> htb_deactivate()

For htb_next_rb_node()
after calling the 1st htb_deactivate()
the
clprio[prio]->ptr could be already set to  NULL
which means
htb_next_rb_node() is vulnerable here.

For htb_deactivate()
although we checked qlen before calling it
in
case of qlen==0 after qdisc_tree_reduce_backlog()
we may call it again
which triggers the warning inside.

To fix the issues here
we need to:

1) Make htb_deactivate() idempotent
that is
simply return if we
   already call it before.
2) Make htb_next_rb_node() safe against ptr==NULL.

Many thanks to Alan for testing and for the reproducer.

Severity: 0.0 | NA

Visit the link for more details
such as CVSS details
affected products
timeline
and more...
