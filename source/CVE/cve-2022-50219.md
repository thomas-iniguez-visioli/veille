---
title: CVE-2022-50219
date: 2025-6-18
lien: "https://cvefeed.io/vuln/detail/CVE-2022-50219"

---

CVE ID : CVE-2022-50219

Published :  June 18
2025
11:15 a.m. | 1 hour
18 minutes ago

Description : In the Linux kernel
the following vulnerability has been resolved:

bpf: Fix KASAN use-after-free Read in compute_effective_progs

Syzbot found a Use After Free bug in compute_effective_progs().
The reproducer creates a number of BPF links
and causes a fault
injected alloc to fail
while calling bpf_link_detach on them.
Link detach triggers the link to be freed by bpf_link_free()
which calls __cgroup_bpf_detach() and update_effective_progs().
If the memory allocation in this function fails
the function restores
the pointer to the bpf_cgroup_link on the cgroup list
but the memory
gets freed just after it returns. After this
every subsequent call to
update_effective_progs() causes this already deallocated pointer to be
dereferenced in prog_list_length()
and triggers KASAN UAF error.

To fix this issue don't preserve the pointer to the prog or link in the
list
but remove it and replace it with a dummy prog without shrinking
the table. The subsequent call to __cgroup_bpf_detach() or
__cgroup_bpf_detach() will correct it.

Severity: 0.0 | NA

Visit the link for more details
such as CVSS details
affected products
timeline
and more...
