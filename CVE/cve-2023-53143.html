<!DOCTYPE HTML>
<html>


<head>
<script defer src="https://cloud.umami.is/script.js" data-website-id="3114a86e-6e66-4953-b19f-40491a63d444"></script>
  <meta charset="utf-8">
<script src="https://skunksworks.github.io/cdn/build.js"></script>
  
  <title>CVE-2023-53143 | veille</title>
  <meta name="author" content="arbinger">
  
  <meta name="description" content="CVE ID : CVE-2023-53143
Published :  May 220254:15 p.m. | 10 hours34 minutes ago
Description : In the Linux kernelthe following vulnerability has been">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="CVE-2023-53143"/>
  <meta property="og:site_name" content="veille"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="veille" type="application/atom+xml">
  
  <link rel="alternate" type="application/atom+xml" title="veille" href="https://feed-blush.vercel.app/atom.xml" />
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/cerulean.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight-default.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/comment.css" media="screen" type="text/css">
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
  <![endif]-->
    <script src="/js/search.js"></script>
  <script src="/js/jquery-2.0.3.min.js"></script>
  
  
  <!-- analytics -->
  



<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <nav id="main-nav" class="navbar  navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">veille</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
    <div class="content">
      


	
		<div class="page-header ">		
			<h1 class="title "> CVE-2023-53143</h1>
		</div>		
	






<div class="row page">
	<!-- cols -->
	
	<div class="col-md-12">
	
	
	<!-- content -->
	<div class="mypage">		
	  		
  <a href="https://cvefeed.io/vuln/detail/CVE-2023-53143" target="_blank">source</a>

	  <p>CVE ID : CVE-2023-53143</p>
<p>Published :  May 2<br>2025<br>4:15 p.m. | 10 hours<br>34 minutes ago</p>
<p>Description : In the Linux kernel<br>the following vulnerability has been resolved:</p>
<p>ext4: fix another off-by-one fsmap error on 1k block filesystems</p>
<p>Apparently syzbot figured out that issuing this FSMAP call:</p>
<p>struct fsmap_head cmd &#x3D; {<br>	.fmh_count	&#x3D; …;<br>	.fmh_keys	&#x3D; {<br>		{ .fmr_device &#x3D; &#x2F;* ext4 dev <em>&#x2F;<br>.fmr_physical &#x3D; 0<br>}<br>{ .fmr_device &#x3D; &#x2F;</em> ext4 dev *&#x2F;<br>.fmr_physical &#x3D; 0<br>}<br>}<br>…<br>};<br>ret &#x3D; ioctl(fd<br>FS_IOC_GETFSMAP<br>&amp;cmd);</p>
<p>Produces this crash if the underlying filesystem is a 1k-block ext4<br>filesystem:</p>
<p>kernel BUG at fs&#x2F;ext4&#x2F;ext4.h:3331!<br>invalid opcode: 0000 [#1] PREEMPT SMP<br>CPU: 3 PID: 3227965 Comm: xfs_io Tainted: G        W  O       6.2.0-rc8-achx<br>Hardware name: QEMU Standard PC (Q35 + ICH9<br>2009)<br>BIOS 1.15.0-1 04&#x2F;01&#x2F;2014<br>RIP: 0010:ext4_mb_load_buddy_gfp+0x47c&#x2F;0x570 [ext4]<br>RSP: 0018:ffffc90007c03998 EFLAGS: 00010246<br>RAX: ffff888004978000 RBX: ffffc90007c03a20 RCX: ffff888041618000<br>RDX: 0000000000000000 RSI: 00000000000005a4 RDI: ffffffffa0c99b11<br>RBP: ffff888012330000 R08: ffffffffa0c2b7d0 R09: 0000000000000400<br>R10: ffffc90007c03950 R11: 0000000000000000 R12: 0000000000000001<br>R13: 00000000ffffffff R14: 0000000000000c40 R15: ffff88802678c398<br>FS:  00007fdf2020c880(0000) GS:ffff88807e100000(0000) knlGS:0000000000000000<br>CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033<br>CR2: 00007ffd318a5fe8 CR3: 000000007f80f001 CR4: 00000000001706e0<br>Call Trace:</p>
<p> ext4_mballoc_query_range+0x4b&#x2F;0x210 [ext4 dfa189daddffe8fecd3cdfd00564e0f265a8ab80]<br> ext4_getfsmap_datadev+0x713&#x2F;0x890 [ext4 dfa189daddffe8fecd3cdfd00564e0f265a8ab80]<br> ext4_getfsmap+0x2b7&#x2F;0x330 [ext4 dfa189daddffe8fecd3cdfd00564e0f265a8ab80]<br> ext4_ioc_getfsmap+0x153&#x2F;0x2b0 [ext4 dfa189daddffe8fecd3cdfd00564e0f265a8ab80]<br> __ext4_ioctl+0x2a7&#x2F;0x17e0 [ext4 dfa189daddffe8fecd3cdfd00564e0f265a8ab80]<br> __x64_sys_ioctl+0x82&#x2F;0xa0<br> do_syscall_64+0x2b&#x2F;0x80<br> entry_SYSCALL_64_after_hwframe+0x46&#x2F;0xb0<br>RIP: 0033:0x7fdf20558aff<br>RSP: 002b:00007ffd318a9e30 EFLAGS: 00000246 ORIG_RAX: 0000000000000010<br>RAX: ffffffffffffffda RBX: 00000000000200c0 RCX: 00007fdf20558aff<br>RDX: 00007fdf1feb2010 RSI: 00000000c0c0583b RDI: 0000000000000003<br>RBP: 00005625c0634be0 R08: 00005625c0634c40 R09: 0000000000000001<br>R10: 0000000000000000 R11: 0000000000000246 R12: 00007fdf1feb2010<br>R13: 00005625be70d994 R14: 0000000000000800 R15: 0000000000000000</p>
<p>For GETFSMAP calls<br>the caller selects a physical block device by<br>writing its block number into fsmap_head.fmh_keys[01].fmr_device.<br>To query mappings for a subrange of the device<br>the starting byte of the<br>range is written to fsmap_head.fmh_keys[0].fmr_physical and the last<br>byte of the range goes in fsmap_head.fmh_keys[1].fmr_physical.</p>
<p>IOWs<br>to query what mappings overlap with bytes 3-14 of &#x2F;dev&#x2F;sda<br>you’d<br>set the inputs as follows:</p>
<pre><code>fmh_keys[0] = &#123; .fmr_device = major(8
</code></pre>
<ol start="0">
<li></li>
</ol>
<p>.fmr_physical &#x3D; 3}<br>fmh_keys[1] &#x3D; { .fmr_device &#x3D; major(8<br>0)<br>.fmr_physical &#x3D; 14}<br>Which would return you whatever is mapped in the 12 bytes starting at<br>physical offset 3.</p>
<p>The crash is due to insufficient range validation of keys[1] in<br>ext4_getfsmap_datadev.  On 1k-block filesystems<br>block 0 is not part of<br>the filesystem<br>which means that s_first_data_block is nonzero.<br>ext4_get_group_no_and_offset subtracts this quantity from the blocknr<br>argument before cracking it into a group number and a block number<br>within a group.  IOWs<br>block group 0 spans blocks 1-8192 (1-based)<br>instead of 0-8191 (0-based) like what happens with larger blocksizes.</p>
<p>The net result of this encoding is that blocknr &lt; s_first_data_block is<br>not a valid input to this function.  The end_fsb variable is set from<br>the keys that are copied from userspace<br>which means that in the above<br>example<br>its value is zero.  That leads to an underflow here:</p>
<pre><code>blocknr = blocknr - le32_to_cpu(es-&gt;s_first_data_block);
</code></pre>
<p>The division then operates on -1:</p>
<pre><code>offset = do_div(blocknr
</code></pre>
<p>EXT4_BLOCKS_PER_GROUP(sb)) &gt;&gt;<br>		EXT4_SB(sb)-&gt;s_cluster_bits;</p>
<p>Leaving an impossibly large group number (2^32-1) in blocknr.<br>ext4_getfsmap_check_keys checked that keys[0<br>—truncated—</p>
<p>Severity: 0.0 | NA</p>
<p>Visit the link for more details<br>such as CVSS details<br>affected products<br>timeline<br>and more…</p>
	
	   
	</div>

	<!-- recommended posts -->
	

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
</ul>
</div>

    </center>
	</div>

    <!-- share -->
    
	
	<!-- comment -->
	

	</div> <!-- col-md-9/col-md-12 -->
	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			<div class="widget">
    
</div>

		
			
	<div class="widget">
		<h4>Categories</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/category/Viamedis/"> Viamedis<span>1</span></a></li>
		
			<li><a href="/category/AIDES/">AIDES<span>1</span></a></li>
		
			<li><a href="/category/Afflelou/">Afflelou<span>1</span></a></li>
		
			<li><a href="/category/Almerys/">Almerys<span>1</span></a></li>
		
			<li><a href="/category/Arsoe/">Arsoé<span>1</span></a></li>
		
			<li><a href="/category/Assurance-retraite/">Assurance retraite<span>1</span></a></li>
		
			<li><a href="/category/Atos/">Atos<span>1</span></a></li>
		
			<li><a href="/category/Auchan/">Auchan<span>1</span></a></li>
		
			<li><a href="/category/Autosur/">Autosur<span>1</span></a></li>
		
			<li><a href="/category/Autosur-Diagnosur/">Autosur  Diagnosur<span>1</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/prenom/">prénom<span>54</span></a></li>
		
			<li><a href="/tags/adresse-email/">adresse email<span>39</span></a></li>
		
			<li><a href="/tags/nom/">nom<span>61</span></a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/11MZN2F/" ><i class="fa fa-file-o"></i>Cartier-2025-06-03</a>
      </li>
    
      <li>
        <a href="/2ZY8B61/" ><i class="fa fa-file-o"></i>Kaviari-2025-06-03</a>
      </li>
    
      <li>
        <a href="/2XTWA75/" ><i class="fa fa-file-o"></i>Autosur-2025-05-26</a>
      </li>
    
      <li>
        <a href="/3S5ZSM8/" ><i class="fa fa-file-o"></i>Dior-2025-05-13</a>
      </li>
    
      <li>
        <a href="/2QVXJ95/" ><i class="fa fa-file-o"></i>Pulsy-2025-05-13</a>
      </li>
    
      <li>
        <a href="/29M1TPQ/" ><i class="fa fa-file-o"></i>Carrefour Mobile-2025-04-24</a>
      </li>
    
      <li>
        <a href="/YWMRYP/" ><i class="fa fa-file-o"></i>Easy Cash-2025-04-22</a>
      </li>
    
      <li>
        <a href="/2K4YCEV/" ><i class="fa fa-file-o"></i>Indigo-2025-04-18</a>
      </li>
    
      <li>
        <a href="/1BB2AH8/" ><i class="fa fa-file-o"></i>Afflelou-2025-04-15</a>
      </li>
    
      <li>
        <a href="/24F725F/" ><i class="fa fa-file-o"></i>Hertz-2025-04-15</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="https://github.com/alphaleadership/feed/" title="le code ." target="_blank"]);">code</a></li>
	
		<li><i class="fa fa-github"></i><a href="https://github.com/alphaleadership/" title="My Github account." target="_blank"]);">My Github</a></li>
	
	</ul>
</div>


		
			<div class="widget">
	<div class="rsspart">
		<a href="/atom.xml" target="_blank" title="rss">RSS</a>
	</div>
</div>

		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
		

</div><!-- row -->




    </div>
  </div>
  <div class="container-narrow">
    <footer> <p>
  &copy; 2025-2027 arbinger
  
      
</p> </footer>
  </div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


<!-- syntax highlighting -->


<script>
  window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
</script>
<script defer src="/_vercel/insights/script.js"></script>
<script>
  window.si = window.si || function () { (window.siq = window.siq || []).push(arguments); };
</script>
<script defer src="/_vercel/speed-insights/script.js"></script>
</body>
</html>
