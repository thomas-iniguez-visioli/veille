---
title: CVE-2022-50215
date: 2025-6-18
lien: "https://cvefeed.io/vuln/detail/CVE-2022-50215"

---

CVE ID : CVE-2022-50215

Published :  June 18
2025
11:15 a.m. | 1 hour
18 minutes ago

Description : In the Linux kernel
the following vulnerability has been resolved:

scsi: sg: Allow waiting for commands to complete on removed device

When a SCSI device is removed while in active use
currently sg will
immediately return -ENODEV on any attempt to wait for active commands that
were sent before the removal.  This is problematic for commands that use
SG_FLAG_DIRECT_IO since the data buffer may still be in use by the kernel
when userspace frees or reuses it after getting ENODEV
leading to
corrupted userspace memory (in the case of READ-type commands) or corrupted
data being sent to the device (in the case of WRITE-type commands).  This
has been seen in practice when logging out of a iscsi_tcp session
where
the iSCSI driver may still be processing commands after the device has been
marked for removal.

Change the policy to allow userspace to wait for active sg commands even
when the device is being removed.  Return -ENODEV only when there are no
more responses to read.

Severity: 0.0 | NA

Visit the link for more details
such as CVSS details
affected products
timeline
and more...
