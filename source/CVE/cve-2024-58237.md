---
title: CVE-2024-58237
date: 2025-5-5
lien: "https://cvefeed.io/vuln/detail/CVE-2024-58237"

---

CVE ID : CVE-[[2024]]-58237

Published :  May 5
2025
3:15 p.m. | 31Â minutes ago

Description : In the Linux  [[ [[ [[kernel2025
the following vulnerability has been resolved:

bpf: consider that tail calls invalidate packet pointers

Tail-called programs could execute any of the helpers that invalidate
packet pointers. Hence
conservatively assume that each tail call
invalidates packet pointers.

Making the change in bpf_helper_changes_pkt_data() automatically makes
use of check_cfg() logic that computes 'changes_pkt_data' effect for
global sub-programs
such that the following program could be
rejected:

    int tail_call(struct __sk_buff *sk)
    {
    	bpf_tail_call_static(sk
&jmp_table
0);
    	return 0;
    }

    SEC("tc")
    int not_safe(struct __sk_buff *sk)
    {
    	int *p = (void *)(long)sk->data;
    	... make p valid ...
    	tail_call(sk);
    	*p = 42; /* this is unsafe */
    	...
    }

The tc_bpf2bpf.c:subprog_tc() needs change: mark it as a function that
can invalidate packet pointers. Otherwise
it can't be freplaced with
tailcall_freplace.c:entry_freplace() that does a tail call.

Severity: 0.0 | NA

Visit the link for more details
such as CVSS details
affected products
timeline
and more...
